
# parent image
FROM python:3.9.10-alpine3.15

WORKDIR /app

# OS installs, pip installs, etc. (https://pkgs.alpinelinux.org/packages)
RUN apk add --no-cache \
    nodejs \
    npm \
    bash \
    mariadb-dev \
    build-base \
    supervisor 

# copy python requirements file and install packages
COPY requirements.txt ./
RUN pip install --no-cache-dir -r requirements.txt

# custom Supervisord config
COPY config/supervisord.dev.conf /etc/supervisord.conf

# TODO: worry about this later
# npm installs
# COPY app/client_new/package.json /tmp/package.json
# RUN cd /tmp && \
# 	npm install && \
# 	mkdir -p ./client && \
# 	cp -a /tmp/node_modules ./client/

# the rest is handled by the docker-compose.dev.yml file
